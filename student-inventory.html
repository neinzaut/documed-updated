<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory</title>
    <link rel="stylesheet" href="inventory.css">
    <link rel="icon" type="image/x-icon" href="logo_notext.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        
        <div class="nav-logo">
            <img src="logo.png" alt="DocuMed Logo">
        </div>
        <div class="nav-links">
            <!-- Notification Icon -->
            <a href="#" class="nav-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
                    <path d="M5 19C4.71667 19 4.47934 18.904 4.288 18.712C4.09667 18.52 4.00067 18.2827 4 18C3.99934 17.7173 4.09534 17.48 4.288 17.288C4.48067 17.096 4.718 17 5 17H6V10C6 8.61667 6.41667 7.38767 7.25 6.313C8.08334 5.23834 9.16667 4.534 10.5 4.2V3.5C10.5 3.08334 10.646 2.72934 10.938 2.438C11.23 2.14667 11.584 2.00067 12 2C12.416 1.99934 12.7703 2.14534 13.063 2.438C13.3557 2.73067 13.5013 3.08467 13.5 3.5V4.2C14.8333 4.53334 15.9167 5.23767 16.75 6.313C17.5833 7.38834 18 8.61734 18 10V17H19C19.2833 17 19.521 17.096 19.713 17.288C19.905 17.48 20.0007 17.7173 20 18C19.9993 18.2827 19.9033 18.5203 19.712 18.713C19.5207 18.9057 19.2833 19.0013 19 19H5ZM12 22C11.45 22 10.9793 21.8043 10.588 21.413C10.1967 21.0217 10.0007 20.5507 10 20H14C14 20.55 13.8043 21.021 13.413 21.413C13.0217 21.805 12.5507 22.0007 12 22Z" fill="#B1B1B1"/>
                    </svg>
            </a>

            <!-- User Icon and Profile Name -->
            <div class="profile-container">
                <div class="profile">
                    <div class="user-icon">
                        <img src="student_profile.png" alt="Doctor Profile">
                    </div>
                    <div class="profile-name">
                        <h3>Maloi Ricalde</h3>
                        <p>Student</p>
                    </div>
                </div>

                <!-- Dropdown for Logout -->
                <div class="dropdown">
                    <button class="dropdown-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M6 7L12 13L18 7L20 9L12 17L4 9L6 7Z" fill="black"/>
                        </svg>
                    </button>
                    <div class="dropdown-menu">
                        <a href="student-profile.html" class="dropdown-item">My Profile</a>
                        <a href="student-login.html" class="dropdown-item">Log out</a>
                    </div>
                </div>
            </div>
            
        </div>
    </nav>


    <nav class="menu" tabindex="0">
        <div class="smartphone-menu-trigger"></div>
        <header class="avatar">
            <img src="student_profile.png" />
            <h2>Maloi Ricalde</h2>
        </header>
        <ul>
            <li tabindex="0" class="icon-dashboard">
                <img src="home-icon.png" alt="Home Icon" style="width:20px; height:20px; margin-right:10px;">
                <a href="student-dashboard.html"><span>Home</span></a>
            </li>
            <li tabindex="0" class="icon-customers">
                <img src="records-icon.png" alt="Records Icon" style="width:20px; height:20px; margin-right:10px;">
                <a href="student-records.html"><span>Records</span></a>
            </li>
            <li tabindex="0" class="icon-users">
                <img src="appointment-icon.png" alt="Appointment Icon" style="width:20px; height:20px; margin-right:10px;">
                <a href="student-appointment.html"><span>Appointment</span></a>
            </li>
            <li tabindex="0" class="icon-users">
                <img src="inventory-icon.png" alt="Inventory Icon" style="width:20px; height:20px; margin-right:10px;">
                <a href="student-inventory.html"><span>Request</span></a>
            </li>
            <!-- <li tabindex="0" class="icon-settings">
                <img src="doctor_profile.png" alt="Logout Icon" style="width:20px; height:20px; margin-right:10px;">
                <span>Log out</span>
            </li> -->
        </ul>
    </nav>
</body>
<div class="main">
    <h1>Borrow Equipment</h1>

    <!-- Inventory Table Section -->
    <div class="inventory-section">
        <div class="inventory-header">
            <div class="left-controls">
                <input type="text" placeholder="Search equipment..." class="search-bar">
                <select class="filter-dropdown">
                    <option value="">Filter by Status</option>
                    <option value="available">Available</option>
                    <option value="low">Low Stock</option>
                    <option value="out">Out of Stock</option>
                </select>
            </div>
        </div>

        <table class="inventory-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Equipment</th>
                    <th>Available Quantity</th>
                    <th>Clinic</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr data-id="INV001">
                    <td>INV001</td>
                    <td>Hot Compress Bag</td>
                    <td>15</td>
                    <td>West Clinic</td>
                    <td><span class="status-available">Available</span></td>
                    <td>
                        <button class="action-btn borrow" onclick="addToBorrowList('INV001')">Add to List</button>
                    </td>
                </tr>
                <tr data-id="INV002">
                    <td>INV002</td>
                    <td>Wheelchair</td>
                    <td>3</td>
                    <td>East Clinic</td>
                    <td><span class="status-low">Low Stock</span></td>
                    <td>
                        <button class="action-btn borrow" onclick="addToBorrowList('INV002')">Add to List</button>
                    </td>
                </tr>
                <tr data-id="INV003">
                    <td>INV003</td>
                    <td>Blood Pressure Monitor</td>
                    <td>0</td>
                    <td>East Clinic</td>
                    <td><span class="status-out">Out of Stock</span></td>
                    <td>
                        <button class="action-btn borrow" onclick="addToBorrowList('INV003')">Add to List</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Borrowing Form Section -->
    <div class="borrowing-section">
        <h2>Borrowing Details</h2>
        <div class="selected-items">
            <h3>Selected Equipment</h3>
            <table class="selected-items-table">
                <thead>
                    <tr>
                        <th>Equipment</th>
                        <th>Quantity</th>
                        <th>Clinic</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="selectedItemsList">
                    <!-- Selected items will be added here dynamically -->
                </tbody>
            </table>
        </div>
        
        <div class="borrowing-form">
            <div class="form-group">
                <label for="borrowDate">Borrow Date:</label>
                <input type="date" id="borrowDate" required>
            </div>
            
            <div class="form-group">
                <label for="borrowReason">Reason for Borrowing:</label>
                <textarea id="borrowReason" rows="4" maxlength="500" 
                    placeholder="Please state your reason for borrowing the equipment..."
                    style="max-width: 100%; min-width: 100%; max-height: 150px;"></textarea>
                <small class="char-count">0/500 characters</small>
                <div class="borrow-form-submit">
                    <button class="borrow-submit-btn" onclick="submitBorrowRequest()">Submit Borrow Request</button>
                </div>
            </div>
            
        </div>
    </div>
</div>
<script>
    let selectedItems = [];

    function addToBorrowList(itemId) {
        // Find the item row
        const row = document.querySelector(`tr[data-id="${itemId}"]`);
        const availableQuantity = parseInt(row.cells[2].textContent);
        
        // Check if item is already in the list
        const existingItem = selectedItems.find(i => i.id === itemId);
        if (existingItem) {
            alert('This item is already in your list');
            return;
        }

        // Check if item is out of stock
        if (availableQuantity === 0) {
            alert('This item is out of stock');
            return;
        }

        const item = {
            id: itemId,
            name: row.cells[1].textContent,
            quantity: 1,
            maxQuantity: availableQuantity,
            clinic: row.cells[3].textContent
        };

        selectedItems.push(item);
        updateSelectedItemsList();
    }

    function removeFromBorrowList(itemId) {
        selectedItems = selectedItems.filter(item => item.id !== itemId);
        updateSelectedItemsList();
    }

    function updateSelectedItemsList() {
        const tbody = document.getElementById('selectedItemsList');
        tbody.innerHTML = '';

        selectedItems.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item.name}</td>
                <td>
                    <input type="number" value="${item.quantity}" min="1" max="${item.maxQuantity}" 
                           onchange="updateQuantity('${item.id}', this.value)"
                           style="width: 70px; padding: 4px;">
                </td>
                <td>${item.clinic}</td>
                <td>
                    <button class="action-btn remove" onclick="removeFromBorrowList('${item.id}')">
                        Remove
                    </button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }

    function updateQuantity(itemId, newQuantity) {
        const item = selectedItems.find(i => i.id === itemId);
        if (item) {
            // Ensure quantity is within valid range
            const quantity = parseInt(newQuantity);
            if (quantity < 1) {
                alert('Quantity must be at least 1');
                updateSelectedItemsList(); // Reset to previous valid state
                return;
            }
            if (quantity > item.maxQuantity) {
                alert(`Maximum available quantity is ${item.maxQuantity}`);
                updateSelectedItemsList(); // Reset to previous valid state
                return;
            }
            item.quantity = quantity;
        }
    }

    document.getElementById('borrowReason').addEventListener('input', function() {
        const maxLength = this.getAttribute('maxlength');
        const currentLength = this.value.length;
        document.querySelector('.char-count').textContent = 
            `${currentLength}/${maxLength} characters`;
    });

    function submitBorrowRequest() {
        const reason = document.getElementById('borrowReason').value;
        const borrowDate = document.getElementById('borrowDate').value;
        
        if (!borrowDate) {
            alert('Please select a borrow date');
            return;
        }
        if (!reason.trim()) {
            alert('Please provide a reason for borrowing');
            return;
        }
        if (selectedItems.length === 0) {
            alert('Please select at least one item to borrow');
            return;
        }

        const borrowRequest = {
            items: selectedItems,
            reason: reason,
            borrowDate: borrowDate,
            timestamp: new Date().toISOString()
        };

        // Here you would typically send this to your backend
        console.log('Borrow Request:', borrowRequest);
        alert('Borrow request submitted successfully!');
        
        // Clear the form
        selectedItems = [];
        updateSelectedItemsList();
        document.getElementById('borrowReason').value = '';
        document.getElementById('borrowDate').value = '';
        document.querySelector('.char-count').textContent = '0/500 characters';
    }
</script>

</html>
